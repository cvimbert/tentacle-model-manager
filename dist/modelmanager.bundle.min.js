//     Underscore.js 1.8.3
//     http://underscorejs.org
//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

//     uuid.js
//
//     Copyright (c) 2010-2012 Robert Kieffer
//     MIT License - http://opensource.org/licenses/mit-license.php

(function(){function n(n){function e(e,t,r,o,i,u){for(;i>=0&&u>i;i+=n){var a=o?o[i]:i;r=t(r,e[a],a,e)}return r}return function(t,r,o,i){r=b(r,i,4);var u=!S(t)&&m.keys(t),a=(u||t).length,l=n>0?0:a-1;return arguments.length<3&&(o=t[u?u[l]:l],l+=n),e(t,r,o,u,l,a)}}function e(n){return function(e,t,r){t=O(t,r);for(var o=N(e),i=n>0?0:o-1;i>=0&&o>i;i+=n)if(t(e[i],i,e))return i;return-1}}function t(n,e,t){return function(r,o,i){var u=0,a=N(r);if("number"==typeof i)n>0?u=i>=0?i:Math.max(i+a,u):a=i>=0?Math.min(i+1,a):i+a+1;else if(t&&i&&a)return i=t(r,o),r[i]===o?i:-1;if(o!==o)return i=e(f.call(r,u,a),m.isNaN),i>=0?i+u:-1;for(i=n>0?u:a-1;i>=0&&a>i;i+=n)if(r[i]===o)return i;return-1}}function r(n,e){var t=L.length,r=n.constructor,o=m.isFunction(r)&&r.prototype||a,i="constructor";for(m.has(n,i)&&!m.contains(e,i)&&e.push(i);t--;)i=L[t],i in n&&n[i]!==o[i]&&!m.contains(e,i)&&e.push(i)}var o=this,i=o._,u=Array.prototype,a=Object.prototype,l=Function.prototype,c=u.push,f=u.slice,s=a.toString,p=a.hasOwnProperty,d=Array.isArray,g=Object.keys,h=l.bind,v=Object.create,y=function(){},m=function(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):o._=m,m.VERSION="1.8.3";var b=function(n,e,t){if(void 0===e)return n;switch(null==t?3:t){case 1:return function(t){return n.call(e,t)};case 2:return function(t,r){return n.call(e,t,r)};case 3:return function(t,r,o){return n.call(e,t,r,o)};case 4:return function(t,r,o,i){return n.call(e,t,r,o,i)}}return function(){return n.apply(e,arguments)}},O=function(n,e,t){return null==n?m.identity:m.isFunction(n)?b(n,e,t):m.isObject(n)?m.matcher(n):m.property(n)};m.iteratee=function(n,e){return O(n,e,1/0)};var T=function(n,e){return function(t){var r=arguments.length;if(2>r||null==t)return t;for(var o=1;r>o;o++)for(var i=arguments[o],u=n(i),a=u.length,l=0;a>l;l++){var c=u[l];e&&void 0!==t[c]||(t[c]=i[c])}return t}},w=function(n){if(!m.isObject(n))return{};if(v)return v(n);y.prototype=n;var e=new y;return y.prototype=null,e},_=function(n){return function(e){return null==e?void 0:e[n]}},j=Math.pow(2,53)-1,N=_("length"),S=function(n){var e=N(n);return"number"==typeof e&&e>=0&&j>=e};m.each=m.forEach=function(n,e,t){e=b(e,t);var r,o;if(S(n))for(r=0,o=n.length;o>r;r++)e(n[r],r,n);else{var i=m.keys(n);for(r=0,o=i.length;o>r;r++)e(n[i[r]],i[r],n)}return n},m.map=m.collect=function(n,e,t){e=O(e,t);for(var r=!S(n)&&m.keys(n),o=(r||n).length,i=Array(o),u=0;o>u;u++){var a=r?r[u]:u;i[u]=e(n[a],a,n)}return i},m.reduce=m.foldl=m.inject=n(1),m.reduceRight=m.foldr=n(-1),m.find=m.detect=function(n,e,t){var r;return r=S(n)?m.findIndex(n,e,t):m.findKey(n,e,t),void 0!==r&&-1!==r?n[r]:void 0},m.filter=m.select=function(n,e,t){var r=[];return e=O(e,t),m.each(n,function(n,t,o){e(n,t,o)&&r.push(n)}),r},m.reject=function(n,e,t){return m.filter(n,m.negate(O(e)),t)},m.every=m.all=function(n,e,t){e=O(e,t);for(var r=!S(n)&&m.keys(n),o=(r||n).length,i=0;o>i;i++){var u=r?r[i]:i;if(!e(n[u],u,n))return!1}return!0},m.some=m.any=function(n,e,t){e=O(e,t);for(var r=!S(n)&&m.keys(n),o=(r||n).length,i=0;o>i;i++){var u=r?r[i]:i;if(e(n[u],u,n))return!0}return!1},m.contains=m.includes=m.include=function(n,e,t,r){return S(n)||(n=m.values(n)),("number"!=typeof t||r)&&(t=0),m.indexOf(n,e,t)>=0},m.invoke=function(n,e){var t=f.call(arguments,2),r=m.isFunction(e);return m.map(n,function(n){var o=r?e:n[e];return null==o?o:o.apply(n,t)})},m.pluck=function(n,e){return m.map(n,m.property(e))},m.where=function(n,e){return m.filter(n,m.matcher(e))},m.findWhere=function(n,e){return m.find(n,m.matcher(e))},m.max=function(n,e,t){var r,o,i=-(1/0),u=-(1/0);if(null==e&&null!=n){n=S(n)?n:m.values(n);for(var a=0,l=n.length;l>a;a++)r=n[a],r>i&&(i=r)}else e=O(e,t),m.each(n,function(n,t,r){o=e(n,t,r),(o>u||o===-(1/0)&&i===-(1/0))&&(i=n,u=o)});return i},m.min=function(n,e,t){var r,o,i=1/0,u=1/0;if(null==e&&null!=n){n=S(n)?n:m.values(n);for(var a=0,l=n.length;l>a;a++)r=n[a],i>r&&(i=r)}else e=O(e,t),m.each(n,function(n,t,r){o=e(n,t,r),(u>o||o===1/0&&i===1/0)&&(i=n,u=o)});return i},m.shuffle=function(n){for(var e,t=S(n)?n:m.values(n),r=t.length,o=Array(r),i=0;r>i;i++)e=m.random(0,i),e!==i&&(o[i]=o[e]),o[e]=t[i];return o},m.sample=function(n,e,t){return null==e||t?(S(n)||(n=m.values(n)),n[m.random(n.length-1)]):m.shuffle(n).slice(0,Math.max(0,e))},m.sortBy=function(n,e,t){return e=O(e,t),m.pluck(m.map(n,function(n,t,r){return{value:n,index:t,criteria:e(n,t,r)}}).sort(function(n,e){var t=n.criteria,r=e.criteria;if(t!==r){if(t>r||void 0===t)return 1;if(r>t||void 0===r)return-1}return n.index-e.index}),"value")};var M=function(n){return function(e,t,r){var o={};return t=O(t,r),m.each(e,function(r,i){var u=t(r,i,e);n(o,r,u)}),o}};m.groupBy=M(function(n,e,t){m.has(n,t)?n[t].push(e):n[t]=[e]}),m.indexBy=M(function(n,e,t){n[t]=e}),m.countBy=M(function(n,e,t){m.has(n,t)?n[t]++:n[t]=1}),m.toArray=function(n){return n?m.isArray(n)?f.call(n):S(n)?m.map(n,m.identity):m.values(n):[]},m.size=function(n){return null==n?0:S(n)?n.length:m.keys(n).length},m.partition=function(n,e,t){e=O(e,t);var r=[],o=[];return m.each(n,function(n,t,i){(e(n,t,i)?r:o).push(n)}),[r,o]},m.first=m.head=m.take=function(n,e,t){return null!=n?null==e||t?n[0]:m.initial(n,n.length-e):void 0},m.initial=function(n,e,t){return f.call(n,0,Math.max(0,n.length-(null==e||t?1:e)))},m.last=function(n,e,t){return null!=n?null==e||t?n[n.length-1]:m.rest(n,Math.max(0,n.length-e)):void 0},m.rest=m.tail=m.drop=function(n,e,t){return f.call(n,null==e||t?1:e)},m.compact=function(n){return m.filter(n,m.identity)};var A=function(n,e,t,r){for(var o=[],i=0,u=r||0,a=N(n);a>u;u++){var l=n[u];if(S(l)&&(m.isArray(l)||m.isArguments(l))){e||(l=A(l,e,t));var c=0,f=l.length;for(o.length+=f;f>c;)o[i++]=l[c++]}else t||(o[i++]=l)}return o};m.flatten=function(n,e){return A(n,e,!1)},m.without=function(n){return m.difference(n,f.call(arguments,1))},m.uniq=m.unique=function(n,e,t,r){m.isBoolean(e)||(r=t,t=e,e=!1),null!=t&&(t=O(t,r));for(var o=[],i=[],u=0,a=N(n);a>u;u++){var l=n[u],c=t?t(l,u,n):l;e?(u&&i===c||o.push(l),i=c):t?m.contains(i,c)||(i.push(c),o.push(l)):m.contains(o,l)||o.push(l)}return o},m.union=function(){return m.uniq(A(arguments,!0,!0))},m.intersection=function(n){for(var e=[],t=arguments.length,r=0,o=N(n);o>r;r++){var i=n[r];if(!m.contains(e,i)){for(var u=1;t>u&&m.contains(arguments[u],i);u++);u===t&&e.push(i)}}return e},m.difference=function(n){var e=A(arguments,!0,!0,1);return m.filter(n,function(n){return!m.contains(e,n)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(n){for(var e=n&&m.max(n,N).length||0,t=Array(e),r=0;e>r;r++)t[r]=m.pluck(n,r);return t},m.object=function(n,e){for(var t={},r=0,o=N(n);o>r;r++)e?t[n[r]]=e[r]:t[n[r][0]]=n[r][1];return t},m.findIndex=e(1),m.findLastIndex=e(-1),m.sortedIndex=function(n,e,t,r){t=O(t,r,1);for(var o=t(e),i=0,u=N(n);u>i;){var a=Math.floor((i+u)/2);t(n[a])<o?i=a+1:u=a}return i},m.indexOf=t(1,m.findIndex,m.sortedIndex),m.lastIndexOf=t(-1,m.findLastIndex),m.range=function(n,e,t){null==e&&(e=n||0,n=0),t=t||1;for(var r=Math.max(Math.ceil((e-n)/t),0),o=Array(r),i=0;r>i;i++,n+=t)o[i]=n;return o};var x=function(n,e,t,r,o){if(!(r instanceof e))return n.apply(t,o);var i=w(n.prototype),u=n.apply(i,o);return m.isObject(u)?u:i};m.bind=function(n,e){if(h&&n.bind===h)return h.apply(n,f.call(arguments,1));if(!m.isFunction(n))throw new TypeError("Bind must be called on a function");var t=f.call(arguments,2),r=function(){return x(n,r,e,this,t.concat(f.call(arguments)))};return r},m.partial=function(n){var e=f.call(arguments,1),t=function(){for(var r=0,o=e.length,i=Array(o),u=0;o>u;u++)i[u]=e[u]===m?arguments[r++]:e[u];for(;r<arguments.length;)i.push(arguments[r++]);return x(n,t,this,this,i)};return t},m.bindAll=function(n){var e,t,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(e=1;r>e;e++)t=arguments[e],n[t]=m.bind(n[t],n);return n},m.memoize=function(n,e){var t=function(r){var o=t.cache,i=""+(e?e.apply(this,arguments):r);return m.has(o,i)||(o[i]=n.apply(this,arguments)),o[i]};return t.cache={},t},m.delay=function(n,e){var t=f.call(arguments,2);return setTimeout(function(){return n.apply(null,t)},e)},m.defer=m.partial(m.delay,m,1),m.throttle=function(n,e,t){var r,o,i,u=null,a=0;t||(t={});var l=function(){a=t.leading===!1?0:m.now(),u=null,i=n.apply(r,o),u||(r=o=null)};return function(){var c=m.now();a||t.leading!==!1||(a=c);var f=e-(c-a);return r=this,o=arguments,0>=f||f>e?(u&&(clearTimeout(u),u=null),a=c,i=n.apply(r,o),u||(r=o=null)):u||t.trailing===!1||(u=setTimeout(l,f)),i}},m.debounce=function(n,e,t){var r,o,i,u,a,l=function(){var c=m.now()-u;e>c&&c>=0?r=setTimeout(l,e-c):(r=null,t||(a=n.apply(i,o),r||(i=o=null)))};return function(){i=this,o=arguments,u=m.now();var c=t&&!r;return r||(r=setTimeout(l,e)),c&&(a=n.apply(i,o),i=o=null),a}},m.wrap=function(n,e){return m.partial(e,n)},m.negate=function(n){return function(){return!n.apply(this,arguments)}},m.compose=function(){var n=arguments,e=n.length-1;return function(){for(var t=e,r=n[e].apply(this,arguments);t--;)r=n[t].call(this,r);return r}},m.after=function(n,e){return function(){return--n<1?e.apply(this,arguments):void 0}},m.before=function(n,e){var t;return function(){return--n>0&&(t=e.apply(this,arguments)),1>=n&&(e=null),t}},m.once=m.partial(m.before,2);var E=!{toString:null}.propertyIsEnumerable("toString"),L=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(n){if(!m.isObject(n))return[];if(g)return g(n);var e=[];for(var t in n)m.has(n,t)&&e.push(t);return E&&r(n,e),e},m.allKeys=function(n){if(!m.isObject(n))return[];var e=[];for(var t in n)e.push(t);return E&&r(n,e),e},m.values=function(n){for(var e=m.keys(n),t=e.length,r=Array(t),o=0;t>o;o++)r[o]=n[e[o]];return r},m.mapObject=function(n,e,t){e=O(e,t);for(var r,o=m.keys(n),i=o.length,u={},a=0;i>a;a++)r=o[a],u[r]=e(n[r],r,n);return u},m.pairs=function(n){for(var e=m.keys(n),t=e.length,r=Array(t),o=0;t>o;o++)r[o]=[e[o],n[e[o]]];return r},m.invert=function(n){for(var e={},t=m.keys(n),r=0,o=t.length;o>r;r++)e[n[t[r]]]=t[r];return e},m.functions=m.methods=function(n){var e=[];for(var t in n)m.isFunction(n[t])&&e.push(t);return e.sort()},m.extend=T(m.allKeys),m.extendOwn=m.assign=T(m.keys),m.findKey=function(n,e,t){e=O(e,t);for(var r,o=m.keys(n),i=0,u=o.length;u>i;i++)if(r=o[i],e(n[r],r,n))return r},m.pick=function(n,e,t){var r,o,i={},u=n;if(null==u)return i;m.isFunction(e)?(o=m.allKeys(u),r=b(e,t)):(o=A(arguments,!1,!1,1),r=function(n,e,t){return e in t},u=Object(u));for(var a=0,l=o.length;l>a;a++){var c=o[a],f=u[c];r(f,c,u)&&(i[c]=f)}return i},m.omit=function(n,e,t){if(m.isFunction(e))e=m.negate(e);else{var r=m.map(A(arguments,!1,!1,1),String);e=function(n,e){return!m.contains(r,e)}}return m.pick(n,e,t)},m.defaults=T(m.allKeys,!0),m.create=function(n,e){var t=w(n);return e&&m.extendOwn(t,e),t},m.clone=function(n){return m.isObject(n)?m.isArray(n)?n.slice():m.extend({},n):n},m.tap=function(n,e){return e(n),n},m.isMatch=function(n,e){var t=m.keys(e),r=t.length;if(null==n)return!r;for(var o=Object(n),i=0;r>i;i++){var u=t[i];if(e[u]!==o[u]||!(u in o))return!1}return!0};var k=function(n,e,t,r){if(n===e)return 0!==n||1/n===1/e;if(null==n||null==e)return n===e;n instanceof m&&(n=n._wrapped),e instanceof m&&(e=e._wrapped);var o=s.call(n);if(o!==s.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+n==""+e;case"[object Number]":return+n!==+n?+e!==+e:0===+n?1/+n===1/e:+n===+e;case"[object Date]":case"[object Boolean]":return+n===+e}var i="[object Array]"===o;if(!i){if("object"!=typeof n||"object"!=typeof e)return!1;var u=n.constructor,a=e.constructor;if(u!==a&&!(m.isFunction(u)&&u instanceof u&&m.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in e)return!1}t=t||[],r=r||[];for(var l=t.length;l--;)if(t[l]===n)return r[l]===e;if(t.push(n),r.push(e),i){if(l=n.length,l!==e.length)return!1;for(;l--;)if(!k(n[l],e[l],t,r))return!1}else{var c,f=m.keys(n);if(l=f.length,m.keys(e).length!==l)return!1;for(;l--;)if(c=f[l],!m.has(e,c)||!k(n[c],e[c],t,r))return!1}return t.pop(),r.pop(),!0};m.isEqual=function(n,e){return k(n,e)},m.isEmpty=function(n){return null==n?!0:S(n)&&(m.isArray(n)||m.isString(n)||m.isArguments(n))?0===n.length:0===m.keys(n).length},m.isElement=function(n){return!(!n||1!==n.nodeType)},m.isArray=d||function(n){return"[object Array]"===s.call(n)},m.isObject=function(n){var e=typeof n;return"function"===e||"object"===e&&!!n},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(n){m["is"+n]=function(e){return s.call(e)==="[object "+n+"]"}}),m.isArguments(arguments)||(m.isArguments=function(n){return m.has(n,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(n){return"function"==typeof n||!1}),m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},m.isNaN=function(n){return m.isNumber(n)&&n!==+n},m.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===s.call(n)},m.isNull=function(n){return null===n},m.isUndefined=function(n){return void 0===n},m.has=function(n,e){return null!=n&&p.call(n,e)},m.noConflict=function(){return o._=i,this},m.identity=function(n){return n},m.constant=function(n){return function(){return n}},m.noop=function(){},m.property=_,m.propertyOf=function(n){return null==n?function(){}:function(e){return n[e]}},m.matcher=m.matches=function(n){return n=m.extendOwn({},n),function(e){return m.isMatch(e,n)}},m.times=function(n,e,t){var r=Array(Math.max(0,n));e=b(e,t,1);for(var o=0;n>o;o++)r[o]=e(o);return r},m.random=function(n,e){return null==e&&(e=n,n=0),n+Math.floor(Math.random()*(e-n+1))},m.now=Date.now||function(){return(new Date).getTime()};var R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=m.invert(R),C=function(n){var e=function(e){return n[e]},t="(?:"+m.keys(n).join("|")+")",r=RegExp(t),o=RegExp(t,"g");return function(n){return n=null==n?"":""+n,r.test(n)?n.replace(o,e):n}};m.escape=C(R),m.unescape=C(I),m.result=function(n,e,t){var r=null==n?void 0:n[e];return void 0===r&&(r=t),m.isFunction(r)?r.call(n):r};var B=0;m.uniqueId=function(n){var e=++B+"";return n?n+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,G=function(n){return"\\"+D[n]};m.template=function(n,e,t){!e&&t&&(e=t),e=m.defaults({},e,m.templateSettings);var r=RegExp([(e.escape||F).source,(e.interpolate||F).source,(e.evaluate||F).source].join("|")+"|$","g"),o=0,i="__p+='";n.replace(r,function(e,t,r,u,a){return i+=n.slice(o,a).replace(U,G),o=a+e.length,t?i+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":r?i+="'+\n((__t=("+r+"))==null?'':__t)+\n'":u&&(i+="';\n"+u+"\n__p+='"),e}),i+="';\n",e.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var u=new Function(e.variable||"obj","_",i)}catch(a){throw a.source=i,a}var l=function(n){return u.call(this,n,m)},c=e.variable||"obj";return l.source="function("+c+"){\n"+i+"}",l},m.chain=function(n){var e=m(n);return e._chain=!0,e};var q=function(n,e){return n._chain?m(e).chain():e};m.mixin=function(n){m.each(m.functions(n),function(e){var t=m[e]=n[e];m.prototype[e]=function(){var n=[this._wrapped];return c.apply(n,arguments),q(this,t.apply(m,n))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var e=u[n];m.prototype[n]=function(){var t=this._wrapped;return e.apply(t,arguments),"shift"!==n&&"splice"!==n||0!==t.length||delete t[0],q(this,t)}}),m.each(["concat","join","slice"],function(n){var e=u[n];m.prototype[n]=function(){return q(this,e.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this),function(n){"use strict";function e(){var e=n.crypto||n.msCrypto;if(!a&&e&&e.getRandomValues)try{var t=new Uint8Array(16);f=a=function(){return e.getRandomValues(t),t},a()}catch(r){}if(!a){var o=new Array(16);l=a=function(){for(var n,e=0;16>e;e++)0===(3&e)&&(n=4294967296*Math.random()),o[e]=n>>>((3&e)<<3)&255;return o},"undefined"!=typeof console&&console.warn&&console.warn("[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()")}}function t(){if("function"==typeof require)try{var n=require("crypto").randomBytes;c=a=n&&function(){return n(16)},a()}catch(e){}}function r(n,e,t){var r=e&&t||0,o=0;for(e=e||[],n.toLowerCase().replace(/[0-9a-f]{2}/g,function(n){16>o&&(e[r+o++]=g[n])});16>o;)e[r+o++]=0;return e}function o(n,e){var t=e||0,r=d;return r[n[t++]]+r[n[t++]]+r[n[t++]]+r[n[t++]]+"-"+r[n[t++]]+r[n[t++]]+"-"+r[n[t++]]+r[n[t++]]+"-"+r[n[t++]]+r[n[t++]]+"-"+r[n[t++]]+r[n[t++]]+r[n[t++]]+r[n[t++]]+r[n[t++]]+r[n[t++]]}function i(n,e,t){var r=e&&t||0,i=e||[];n=n||{};var u=null!=n.clockseq?n.clockseq:m,a=null!=n.msecs?n.msecs:(new Date).getTime(),l=null!=n.nsecs?n.nsecs:O+1,c=a-b+(l-O)/1e4;if(0>c&&null==n.clockseq&&(u=u+1&16383),(0>c||a>b)&&null==n.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");b=a,O=l,m=u,a+=122192928e5;var f=(1e4*(268435455&a)+l)%4294967296;i[r++]=f>>>24&255,i[r++]=f>>>16&255,i[r++]=f>>>8&255,i[r++]=255&f;var s=a/4294967296*1e4&268435455;i[r++]=s>>>8&255,i[r++]=255&s,i[r++]=s>>>24&15|16,i[r++]=s>>>16&255,i[r++]=u>>>8|128,i[r++]=255&u;for(var p=n.node||y,d=0;6>d;d++)i[r+d]=p[d];return e?e:o(i)}function u(n,e,t){var r=e&&t||0;"string"==typeof n&&(e="binary"===n?new p(16):null,n=null),n=n||{};var i=n.random||(n.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var u=0;16>u;u++)e[r+u]=i[u];return e||o(i)}var a,l,c,f,s;n?e():t();for(var p="function"==typeof Buffer?Buffer:Array,d=[],g={},h=0;256>h;h++)d[h]=(h+256).toString(16).substr(1),g[d[h]]=h;var v=a(),y=[1|v[0],v[1],v[2],v[3],v[4],v[5]],m=16383&(v[6]<<8|v[7]),b=0,O=0,T=u;T.v1=i,T.v4=u,T.parse=r,T.unparse=o,T.BufferClass=p,T._rng=a,T._mathRNG=l,T._nodeRNG=c,T._whatwgRNG=f,"undefined"!=typeof module&&module.exports?module.exports=T:"function"==typeof define&&define.amd?define("uuid",[],function(){return T}):(s=n.uuid,T.noConflict=function(){return n.uuid=s,T},n.uuid=T)}("undefined"!=typeof window?window:null),function(n){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;"function"==typeof define&&define.amd?define("constants",[],function(){return n()}):e.TentacleManagerConstants=n()}(function(){return{BaseObjectTypes:{STRING:"string",BOOLEAN:"boolean",NUMBER:"number"},Exceptions:{cantfinddescriptor:"Can't find ClassDescriptor '$$' in descriptors",badloggerargs:"Bad logger arguments",verywell:"Everything is fine !",cantFindModelProperty:"Can't find property '$$' in model of type '$$'"},FilterOperand:{AND:"and",OR:"or"},LoggerLevels:{LOG:"log",WARNING:"warning",ERROR:"error"},ModelDecriptorTypes:{CONDITIONAL_ATTRIBUTES_SET:"ConditionalAttributesSet",COLLECTION:"collection",LINKED_CONDITIONAL_ATTRIBUTES_SET:"LinkedConditionalAttributesSet",INCLUDE:"include",REFERENCE_ATTRIBUTE_VALUE:"referenceattributevalue"}}}),function(n){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;"function"==typeof define&&define.amd?define("model",["underscore","uuid","constants"],function(e,t,r){return n(e,t,r)}):e.TentacleModel=n(e._,e.uuid,e.TentacleManagerConstants)}(function(n,e,t){return function(r,o){function i(e,r){n.each(e,function(n,e){if(a.attributes[e])n.type===t.ModelDecriptorTypes.CONDITIONAL_ATTRIBUTES_SET?(r[e]=a.attributes[e],i(n.attributesSets[a.attributes[e]],r)):r[e]=a.attributes[e];else switch(n.type){case t.BaseObjectTypes.STRING:r[e]="";break;case t.BaseObjectTypes.NUMBER:n.defaultvalue?r[e]=n.defaultvalue:r[e]=0;break;case t.BaseObjectTypes.BOOLEAN:n.defaultvalue?r[e]=n.defaultvalue:r[e]="false";break;case t.ModelDecriptorTypes.CONDITIONAL_ATTRIBUTES_SET:r[e]="";break;case t.ModelDecriptorTypes.COLLECTION:r[e]=[];break;default:r[e]=""}})}var u,a=this;if(this.attributes={},this.trashCan={},r)for(var l in r)this[l]=r[l];o&&(u=o),this.init=function(){this.mutate()},this.create=function(n,t,r){if(this.type=n,this.uid=e.v4(),u=t,r)for(var o in r)this.set(o,r[o]);this.init()},this.set=function(n,e){this.attributes[n]=e,this.mutate()},this.get=function(n){return this.attributes[n]?this.attributes[n]:null},this.mutate=function(){var e=u.getClassDescriptor(this.type);n.each(this.attributes,function(n,e){a.trashCan[e]=n});var t={},r=e.flattenByItem(this);i(r,t),this.attributes=t},this.clearTrashCan=function(){this.trashCan={}},this.clone=function(){var n=JSON.stringify(this);return JSON.parse(n)}}}),function(n){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;"function"==typeof define&&define.amd?define("logger",["underscore","constants"],function(e,t){return n(e,t)}):e.TentacleLogger=n(e._,e.TentacleManagerConstants)}(function(n,e){return function(){this.sendLog=function(t,r,o){o||(o=e.LoggerLevels.WARNING);var i="$$";if("object"==typeof r)n.each(r,function(n){var e=t.indexOf(i,1);t=t.slice(0,e)+n+t.slice(e+i.length,t.length)});else{if("string"!=typeof r)return void console.log(e.Exceptions.badloggerargs);t=t.replace("$$",r)}switch(o){case e.LoggerLevels.LOG:console.log(t);break;case e.LoggerLevels.WARNING:console.warn(t);break;case e.LoggerLevels.ERROR:console.error(t)}},this.log=function(n,t){this.sendLog(n,t,e.LoggerLevels.LOG)},this.warn=function(n,t){this.sendLog(n,t,e.LoggerLevels.WARNING)},this.error=function(n,t){this.sendLog(n,t,e.LoggerLevels.ERROR)}}}),function(n){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;"function"==typeof define&&define.amd?define("modeldescriptor",["underscore","logger","constants"],function(e,t,r){return n(e,t,r)}):e.TentacleModelDescriptor=n(e._,e.TentacleLogger,e.TentacleManagerConstants)}(function(n,e,t){return function(o){var i=this,u={};this.load=function(e){n.each(e,function(n,e){var t=new r(e,n,i,o);u[e]=t})},this.getClassDescriptor=function(n){return u[n]?u[n]:(e.log(t.Exceptions.cantfinddescriptor,n),null)}};var r}),function(n){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;"function"==typeof define&&define.amd?define("filter",[],function(){return n()}):e.TentacleFilter=n()}(function(){return function(n,e){this.propertyName=n,this.propertyValue=e}}),function(n){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;"function"==typeof define&&define.amd?define("filtersset",["filter"],function(e){return n(e)}):e.TentacleFiltersSet=n(e.TentacleFilter)}(function(n){return function(e){this.operand=e,this.filters=[],this.addFilter=function(e,t){this.filters.push(new n(e,t))}}}),function(n){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;"function"==typeof define&&define.amd?define("modelmanager",["underscore","model","modeldescriptor","filter","filtersset","constants"],function(e,t,r,o,i,u){return n(e,t,r,o,i,u)}):e.TentacleModelManager=n(_,e.TentacleModel,e.TentacleModelDescriptor,e.TentacleFilter,e.TentacleFiltersSet,e.TentacleManagerConstants)}(function(n,e,t,r,o,i){return function(){var u,a={},l={},c=this;this.init=function(n){u=t(this),u.load(n)},this.addModel=function(n,t,r){var o=new e;return o.create(n,this,r),t!==!1&&this.registerModel(o),o},this.registerModel=function(n){a[n.uid]=n,l[n.type]||(l[n.type]={}),l[n.type][n.uid]=n},this.loadModel=function(t){if(localStorage["model-"+t]){var r=JSON.parse(localStorage["model-"+t]);n.each(r,function(n){l[n.type]||(l[n.type]={}),l[n.type][n.uid]=new e(n,c),a[n.uid]=l[n.type][n.uid]}),localStorage.defaultModel=t}},this.getDescriptors=function(){return u.getDescriptors()},this.getClassDescriptor=function(n){return u.getClassDescriptor(n)},this.saveObject=function(n,e){l[n]||(l[n]={}),l[n][e.uid]=e,a[e.uid]=e},this.loadDefaultModel=function(){localStorage.defaultModel?c.loadModel(localStorage.defaultModel):c.loadModel("base")},this.saveDefaultModel=function(){localStorage.defaultModel?c.saveToStorage(localStorage.defaultModel):c.saveToStorage("base")},this.saveToStorage=function(n){n?localStorage["model-"+n]=JSON.stringify(a):localStorage.model=JSON.stringify(a),localStorage.defaultModel=n},this.deleteLocalStorage=function(n){n?delete localStorage["model-"+n]:delete localStorage.model},this.getModel=function(){return l},this.getModelByUid=function(n){return a[n]},this.getModelByType=function(n,e){if(e){var t={};for(var u in l[n]){var a=l[n][u];if(e instanceof r)a.get(e.propertyName)&&a.get(e.propertyName)===e.propertyValue&&(t[u]=a);else if(e instanceof o){var c;e.operand===i.FilterOperand.AND?c=!0:e.operand===i.FilterOperand.OR&&(c=!1);for(var f=0;f<e.filters.length;f++){var s=e.filters[f];if(a.get(s.propertyName)){var p=a.get(s.propertyName)===s.propertyValue;if(e.operand===i.FilterOperand.AND){if(!p){c=!1;break}}else if(e.operand===i.FilterOperand.OR&&p){c=!0;break}}}}c&&(t[u]=a)}return t}return l[n]},this.deleteItem=function(n,e){delete l[n][e.uid],delete a[e.uid]},this.clearModel=function(){n.each(l,function(n,e){delete l[e]}),a={}}}});